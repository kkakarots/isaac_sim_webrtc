<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Isaac Sim Web Viewer</title>
  <style>
    html, body {
      margin: 0;
      height: 100%;
      background: #000;
      overflow: hidden;
    }
    #video {
      width: 100%;
      height: 100%;
      object-fit: contain;
    }
  </style>
</head>
<body>
  <video id="video" autoplay playsinline></video>
  <script>
    const simHost = "192.168.1.100"; // <-- Isaac Sim 的 IP
    const simPort = 8211;            // <-- Isaac Sim 的 WebRTC 端口

    const wsUrl = `ws://${simHost}:${simPort}/webrtc`;
    const ws = new WebSocket(wsUrl);
    const pc = new RTCPeerConnection();

    const video = document.getElementById("video");
    pc.ontrack = (event) => { video.srcObject = event.streams[0]; };

    ws.onmessage = async (msg) => {
      const data = JSON.parse(msg.data);
      if (data.type === "offer") {
        await pc.setRemoteDescription({ type: "offer", sdp: data.sdp });
        const answer = await pc.createAnswer();
        await pc.setLocalDescription(answer);
        ws.send(JSON.stringify({ type: "answer", sdp: pc.localDescription.sdp }));
      } else if (data.type === "ice") {
        pc.addIceCandidate(data.candidate);
      }
    };

    pc.onicecandidate = (event) => {
      if (event.candidate) {
        ws.send(JSON.stringify({ type: "ice", candidate: event.candidate }));
      }
    };
  </script>
</body>
</html>